# Akizuki Receipt Exporter

秋月電子通商の注文履歴から領収書・納品書・請求書を一括でPDFダウンロードできるChrome拡張機能です。

## 機能

- 注文履歴ページで注文をチェックボックスで選択
- 領収書・納品書・請求書を一括PDF保存
- 会社名・部署名の自動入力機能
- カスタマイズ可能なファイル名パターン
- Googleスプレッドシート連携（分類用ドロップダウン）

## インストール方法

1. このフォルダをダウンロード
2. Chromeで `chrome://extensions` を開く
3. 右上の「デベロッパーモード」をONにする
4. 「パッケージ化されていない拡張機能を読み込む」をクリック
5. ダウンロードしたフォルダを選択

## 使い方

### 基本操作

1. 秋月電子通商にログイン
2. [注文履歴ページ](https://akizukidenshi.com/catalog/customer/history.aspx)を開く
3. ダウンロードしたい注文のチェックボックスをONにする
4. 拡張機能のポップアップを開く
5. 保存したい書類（領収書/納品書/請求書）を選択
6. 「選択した注文をダウンロード」ボタンをクリック

### 会社名・部署名の自動入力

1. 拡張機能のポップアップで「詳細設定」をクリック
2. 「宛名自動入力」セクションで会社名・部署名を入力
3. 「設定を保存」をクリック
4. 注文履歴ページで注文をチェックすると、自動的に会社名・部署名が入力されます

### ファイル名パターン

以下の変数を使用してファイル名をカスタマイズできます：

| 変数 | 説明 | 例 |
|------|------|-----|
| `{date}` | 注文日 | 2025-11-21 |
| `{order_id}` | 注文番号 | EC251121-285552082-01 |
| `{base_order_id}` | ベース注文番号 | EC251121-285552082 |
| `{type}` | 書類種別 | 領収書, 納品書, 請求書 |
| `{price}` | 金額（数字のみ） | 31900 |
| `{product}` | 商品名（最大30文字） | Raspberry Pi 5 8GB |
| `{dropdown}` | ドロップダウン選択値 | - |

**例:** `{date}_{order_id}_{type}` → `2025-11-21_EC251121-285552082-01_領収書.pdf`

### スプレッドシート連携

経費精算などで分類項目をドロップダウンから選択したい場合：

1. Googleスプレッドシートで分類リストを作成
2. スプレッドシートの共有設定で「リンクを知っている全員が閲覧可能」に設定
3. 詳細設定画面でスプレッドシートURL、シート名、列を設定
4. 「データをテスト取得」で確認
5. 設定を保存

注文履歴ページにドロップダウンが表示され、選択した値をファイル名に使用できます。

## 保存先

ダウンロードしたPDFは、ブラウザのダウンロードフォルダ内の `AkizukiReceipts` フォルダに保存されます。

## 注意事項

- 初回の「領収書発行」ボタンを押すと、秋月電子側で「発行済み」となります（次回から「再発行」の文字が入ります）
- 大量のダウンロードを行う場合は、サーバー負荷を考慮して少しずつ実行してください
- この拡張機能は非公式のツールです。秋月電子通商とは関係ありません

## 必要な権限

- `activeTab`: 現在のタブでの操作
- `downloads`: PDFファイルのダウンロード
- `storage`: 設定の保存
- `debugger`: HTMLページをPDFに変換

## ライセンス

MIT License

## 更新履歴

### v1.0
- 初回リリース
- 領収書・納品書・請求書の一括ダウンロード
- 会社名・部署名の自動入力
- ファイル名パターンのカスタマイズ
- スプレッドシート連携
